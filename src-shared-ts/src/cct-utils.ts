import { clamp } from '../../src-ui/app/utils/number-utils';

export function getCSSColorForCCT(temp: number): string {
  temp = clamp(temp, CCT_TO_RGB_MAP_KEYS[0], CCT_TO_RGB_MAP_KEYS.at(-1)!);
  if (temp % 50 === 0)
    return `rgb(${CCT_TO_RGB_MAP[temp].map((v) => Math.round(v * 255)).join(', ')})`;
  const upper = Math.ceil(temp / 50) * 50;
  const lower = upper - 50;
  const upperColor = CCT_TO_RGB_MAP[upper];
  const lowerColor = CCT_TO_RGB_MAP[lower];
  const ratio = (temp - lower) / (upper - lower);
  const color = upperColor.map((v, i) => v * ratio + lowerColor[i] * (1 - ratio));
  return `rgb(${color.map((v) => Math.round(v * 255)).join(', ')})`;
}

export const CCT_TO_RGB_MAP: Record<number, [number, number, number]> = {
  1000: [1, 0.2663545845364998, 0],
  1050: [1, 0.28538672880411137, 0],
  1100: [1, 0.30353332994732996, 0],
  1150: [1, 0.32087314367002634, 0],
  1200: [1, 0.33747486525431103, 0],
  1250: [1, 0.3533987733252725, 0],
  1300: [1, 0.3686980510325512, 0],
  1350: [1, 0.38341985775536086, 0],
  1400: [1, 0.3976062058096456, 0],
  1450: [1, 0.41129468324271445, 0],
  1500: [1, 0.42451905404308377, 0],
  1550: [1, 0.43730975989743237, 0],
  1600: [1, 0.4496943422598453, 0],
  1650: [1, 0.4616977994539139, 0],
  1700: [1, 0.47334289045027494, 0],
  1750: [1, 0.4846503945984184, 0],
  1800: [1, 0.495639334760895, 0],
  1850: [1, 0.5063271698688462, 0],
  1900: [1, 0.516729961793658, 0],
  1950: [1, 0.5268625205391352, 0.02666290013115245],
  2000: [1, 0.5367385310486179, 0.05452576587829767],
  2050: [1, 0.5463706643518018, 0.08102891429693419],
  2100: [1, 0.5557706753162297, 0.10629890261932048],
  2150: [1, 0.5649494888952183, 0.13044540183571185],
  2200: [1, 0.5739172764594482, 0.153564073329914],
  2250: [1, 0.5826835235496676, 0.17573885789833582],
  2300: [1, 0.5912570901821447, 0.19704381555694167],
  2350: [1, 0.5996462646680687, 0.21754461794046967],
  2400: [1, 0.6078588117664293, 0.23729976915803278],
  2450: [1, 0.6159020158715643, 0.25636161231835186],
  2500: [1, 0.6237827198373904, 0.2747771653499521],
  2550: [1, 0.6315073599568588, 0.2925888197211213],
  2600: [1, 0.6390819975446695, 0.30983492819101255],
  2650: [1, 0.646512347511538, 0.32655030209097474],
  2700: [1, 0.6538038042674791, 0.3427666343489381],
  2750: [1, 0.6609614652482209, 0.35851286117807113],
  2800: [1, 0.6679901523217638, 0.37381547280156846],
  2850: [1, 0.6748944313002421, 0.38869878159520715],
  2900: [1, 0.6816786297548326, 0.40318515446390524],
  2950: [1, 0.6883468533077903, 0.4172952150285962],
  3000: [1, 0.6949030005552019, 0.4310480202110507],
  3050: [1, 0.7013507767562799, 0.4444612150110085],
  3100: [1, 0.7076937064095505, 0.45755116862968725],
  3150: [1, 0.7139351448228135, 0.4703330945740446],
  3200: [1, 0.7200782887719634, 0.4828211569520737],
  3250: [1, 0.7261261863334421, 0.4950285648216064],
  3300: [1, 0.7320817459660321, 0.5069676561684651],
  3350: [1, 0.7379477449097269, 0.5186499728524897],
  3400: [1, 0.7437268369623932, 0.5300863276626673],
  3450: [1, 0.7494215596887287, 0.5412868644578063],
  3500: [1, 0.7550343411105364, 0.5522611122310889],
  3550: [1, 0.7605675059224611, 0.5630180338205926],
  3600: [1, 0.7660232812730132, 0.5735660698896949],
  3650: [1, 0.7714038021468644, 0.5839131787180708],
  3700: [1, 0.7767111163809646, 0.594066872273223],
  3750: [1, 0.7819471893439746, 0.6040342489721119],
  3800: [1, 0.7871139083057762, 0.6138220234907861],
  3850: [1, 0.7922130865213668, 0.62343655393556],
  3900: [1, 0.7972464670512533, 0.6328838666511051],
  3950: [1, 0.8022157263384924, 0.6421696789078688],
  4000: [1, 0.8071224775607361, 0.6512994196827054],
  4050: [1, 0.8119682737740629, 0.6602782487218553],
  4100: [1, 0.81675461086392, 0.6691110740538744],
  4150: [1, 0.8214829303172054, 0.6778025681013417],
  4200: [1, 0.8261546218283479, 0.6863571825237659],
  4250: [1, 0.8307710257511658, 0.6947791619097331],
  4300: [1, 0.8353334354073367, 0.703072556423728],
  4350: [1, 0.8398430992614165, 0.711241233501953],
  4400: [1, 0.8443012229715662, 0.7192888886816914],
  4450: [1, 0.8487089713244085, 0.7272190556401196],
  4500: [1, 0.8530674700617857, 0.7350351155108239],
  4550: [1, 0.857377807606588, 0.7427403055395049],
  4600: [1, 0.8616410366942628, 0.7503377271343215],
  4650: [1, 0.8658581759161347, 0.7578303533609905],
  4700: [1, 0.8700302111801866, 0.7652210359279604],
  4750: [1, 0.8741580970945488, 0.7725125117027436],
  4800: [1, 0.8782427582785476, 0.7797074087966586],
  4850: [1, 0.8822850906058206, 0.786808252251847],
  4900: [1, 0.8862859623836823, 0.7938174693613494],
  4950: [1, 0.8902462154726162, 0.8007373946502989],
  5000: [1, 0.8941666663495087, 0.8075702745438039],
  5050: [1, 0.8980481071179868, 0.8143182717448771],
  5100: [1, 0.901891306468977, 0.8209834693437615],
  5150: [1, 0.9056970105944117, 0.8275678746781835],
  5200: [1, 0.9094659440567877, 0.8340734229624407],
  5250: [1, 0.9131988106171205, 0.8405019807017295],
  5300: [1, 0.9168962940236561, 0.8468553489067976],
  5350: [1, 0.9205590587635526, 0.8531352661227594],
  5400: [1, 0.9241877507795973, 0.8593434112848266],
  5450: [1, 0.9277829981538955, 0.8654814064126894],
  5500: [1, 0.931345411760339, 0.8715508191543596],
  5550: [1, 0.9348755858875484, 0.8775531651894685],
  5600: [1, 0.9383740988338822, 0.8834899105012184],
  5650: [1, 0.9418415134759961, 0.8893624735255286],
  5700: [1, 0.9452783778123603, 0.8951722271852425],
  5750: [1, 0.9486852254830355, 0.9009205008166967],
  5800: [1, 0.9520625762669506, 0.9066085819954205],
  5850: [1, 0.9554109365578374, 0.9122377182672322],
  5900: [1, 0.9587307998199085, 0.917809118790559],
  5950: [1, 0.9620226470243116, 0.9233239558953826],
  6000: [1, 0.9652869470673199, 0.9287833665638421],
  6050: [1, 0.9685241571711692, 0.9341884538371759],
  6100: [1, 0.9717347232683982, 0.9395402881533457],
  6150: [1, 0.9749190803705041, 0.9448399086194148],
  6200: [1, 0.9780776529216687, 0.9500883242224482],
  6250: [1, 0.9812108551382817, 0.9552865149824789],
  6300: [1, 0.9843190913349317, 0.9604354330508243],
  6350: [1, 0.987402756237519, 0.9655360037568387],
  6400: [1, 0.9904622352840814, 0.9705891266059762],
  6450: [1, 0.9934979049139205, 0.975595676231858],
  6500: [1, 0.9965101328455601, 0.9805565033048651],
  6550: [1, 0.9994992783440582, 0.9854724353996146],
  6600: [1, 1, 1],
  6650: [1, 0.9809558609736604, 1],
  6700: [0.9977138695348023, 0.9754815166328815, 1],
  6750: [0.9885867050261825, 0.9704124875608662, 1],
  6800: [0.980124411709384, 0.9656945750509994, 1],
  6850: [0.9722413014585665, 0.9612836725323792, 1],
  6900: [0.9648669859344124, 0.9571434169027501, 1],
  6950: [0.9579429664662239, 0.9532434839377462, 1],
  7000: [0.9514201197662264, 0.9495583271489968, 1],
  7050: [0.9452568119407998, 0.9460662287077036, 1],
  7100: [0.9394174618873457, 0.9427485742823196, 1],
  7150: [0.9338714317971714, 0.939589291354029, 1],
  7200: [0.92859215954344, 0.9365744087653701, 1],
  7250: [0.9235564725066565, 0.9336917074535532, 1],
  7300: [0.9187440392731107, 0.9309304406546005, 1],
  7350: [0.9141369273502689, 0.9282811076597562, 1],
  7400: [0.9097192432936254, 0.9257352692995939, 1],
  7450: [0.9054768375388108, 0.9232853962655538, 1],
  7500: [0.9013970605078236, 0.9209247435099642, 1],
  7550: [0.8974685596948607, 0.9186472455328257, 1],
  7600: [0.8936811097650761, 0.9164474285292263, 1],
  7650: [0.8900254694456516, 0.9143203362473368, 1],
  7700: [0.8864932603112867, 0.912261467071931, 1],
  7750: [0.8830768635774966, 0.9102667203577542, 1],
  7800: [0.8797693317950178, 0.9083323504306503, 1],
  7850: [0.8765643129449434, 0.9064549269808725, 1],
  7900: [0.8734559849092142, 0.9046313008135647, 1],
  7950: [0.8704389986658598, 0.902858574111512, 1],
  8000: [0.8675084288560855, 0.9011340745165255, 1],
  8050: [0.8646597306082882, 0.899455332456946, 1],
  8100: [0.8618887016954847, 0.8978200612463101, 1],
  8150: [0.8591914492574533, 0.8962261395572576, 1],
  8200: [0.8565643604447896, 0.8946715959391178, 1],
  8250: [0.8540040764449974, 0.8931545951003135, 1],
  8300: [0.8515074694352764, 0.8916734257200553, 1],
  8350: [0.8490716220764354, 0.8902264895896264, 1],
  8400: [0.8466938092202043, 0.8888122919132841, 1],
  8450: [0.8443714815503586, 0.8874294326235946, 1],
  8500: [0.8421022509183214, 0.8860765985867549, 1],
  8550: [0.8398838771676738, 0.8847525565908879, 1],
  8600: [0.8377142562704534, 0.883456147024987, 1],
  8650: [0.8355914096221547, 0.8821862781686296, 1],
  8700: [0.8335134743627397, 0.8809419210231327, 1],
  8750: [0.8314786946083165, 0.8797221046238212, 1],
  8800: [0.8294854134929497, 0.8785259117807711, 1],
  8850: [0.827532065932752, 0.877352475201973, 1],
  8900: [0.8256171720352922, 0.87620097395853, 1],
  8950: [0.8237393310867268, 0.8750706302563828, 1],
  9000: [0.8218972160571649, 0.8739607064832815, 1],
  9050: [0.8200895685717784, 0.8728705025033712, 1],
  9100: [0.8183151943012548, 0.8717993531749451, 1],
  9150: [0.8165729587304793, 0.8707466260696801, 1],
  9200: [0.8148617832689486, 0.8697117193740851, 1],
  9250: [0.8131806416704508, 0.8686940599560081, 1],
  9300: [0.8115285567330771, 0.8676931015808984, 1],
  9350: [0.8099045972537372, 0.866708323264146, 1],
  9400: [0.8083078752140685, 0.8657392277472599, 1],
  9450: [0.8067375431770432, 0.8647853400869, 1],
  9500: [0.8051927918756929, 0.8638462063469088, 1],
  9550: [0.8036728479772527, 0.8629213923844642, 1],
  9600: [0.8021769720076888, 0.8620104827223612, 1],
  9650: [0.8007044564230537, 0.8611130795002103, 1],
  9700: [0.7992546238154251, 0.8602288014980274, 1],
  9750: [0.7978268252423624, 0.8593572832263177, 1],
  9800: [0.7964204386698478, 0.8584981740773032, 1],
  9850: [0.7950348675196266, 0.8576511375324408, 1],
  9900: [0.793669539312689, 0.8568158504218187, 1],
  9950: [0.7923239044013862, 0.8559920022314184, 1],
  10000: [0.7909974347833513, 0.8551792944545848, 1],
};

export const CCT_TO_RGB_MAP_KEYS = Object.keys(CCT_TO_RGB_MAP).map(Number);
