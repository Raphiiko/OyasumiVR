<div class="pane main">
  <div class="pane-title" translate>auto-invite-request-accept.title</div>
  <div class="pane-content">
    <div class="setting-view-container">
      <p translate>auto-invite-request-accept.description</p>
      <div class="alert warning" *ngIf="!loggedIn" @vshrink>
        <div class="alert-bg"></div>
        <div class="alert-icon">
          <i class="material-icons"> warning </i>
        </div>
        <div class="alert-content">
          <span>{{ 'shared.common.vrcLoginRequired' | translate }}</span>
          <button class="btn btn-secondary" (click)="login()" translate>shared.modals.login</button>
        </div>
      </div>
      <div class="alert warning" *ngIf="isOnBusyStatus" @vshrink>
        <div class="alert-bg"></div>
        <div class="alert-icon">
          <i class="material-icons"> warning </i>
        </div>
        <div class="alert-content">
          <span>{{ 'auto-invite-request-accept.userOnBusyStatus' | translate }}</span></div
        >
      </div>
      <div class="alert warning" *ngIf="isOnJoinMeStatus" @vshrink>
        <div class="alert-bg"></div>
        <div class="alert-icon">
          <i class="material-icons"> warning </i>
        </div>
        <div class="alert-content">
          <span>{{ 'auto-invite-request-accept.userOnJoinMeStatus' | translate }}</span></div
        >
      </div>
      <div class="settings">
        <div class="setting-row">
          <div class="setting-row-label">
            <span translate>auto-invite-request-accept.options.enable.title</span>
            <span translate>auto-invite-request-accept.options.enable.description</span>
          </div>
          <div class="setting-row-action">
            <label class="switch-toggle">
              <input
                type="checkbox"
                [checked]="config.enabled"
                (change)="updateConfig({ enabled: !config.enabled })"
              />
              <span class="switch-toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="setting-row">
          <div class="setting-row-label" translate>
            <span translate>auto-invite-request-accept.options.listMode.title</span>
            <span translate>auto-invite-request-accept.options.listMode.description</span>
          </div>
          <div class="setting-row-action">
            <app-select-box
              [items]="listModeOptions"
              [selected]="listModeOption"
              (selectedChange)="setListMode($event?.id)"
            ></app-select-box>
          </div>
        </div>
        <div class="setting-row">
          <div class="setting-row-label" translate>
            <span translate>auto-invite-request-accept.options.acceptMessage.title</span>
            <span translate>auto-invite-request-accept.options.acceptMessage.description</span>
          </div>
          <div class="setting-row-action">
            <label class="switch-toggle">
              <input
                type="checkbox"
                [checked]="config.acceptMessageEnabled"
                (change)="updateConfig({ acceptMessageEnabled: !config.acceptMessageEnabled })"
              />
              <span class="switch-toggle-slider"></span>
            </label>
          </div>
        </div>
        <div class="setting-row-group" @vshrink *ngIf="config.acceptMessageEnabled">
          <div class="setting-row">
            <div class="setting-row-label" translate>
              <span translate
                >auto-invite-request-accept.options.acceptMessage.customMessage.title</span
              >
              <span></span>
            </div>
            <div class="setting-row-action">
              <input
                maxlength="64"
                type="text"
                class="input"
                [value]="config.acceptInviteRequestMessage"
                (change)="
                  updateAcceptInviteRequestCustomMessage.next(
                    acceptOnRequestCustomMessageInput.value
                  )
                "
                (blur)="acceptOnRequestCustomMessageInput.value = config.acceptInviteRequestMessage"
                [placeholder]="
                  'auto-invite-request-accept.options.acceptMessage.customMessage.placeholder'
                    | translate
                "
                #acceptOnRequestCustomMessageInput
              />
            </div>
          </div>
        </div>
        <div class="setting-row">
          <div class="setting-row-label" translate>
            <span translate>auto-invite-request-accept.options.declineOnRequest.title</span>
            <span translate>auto-invite-request-accept.options.declineOnRequest.description</span>
          </div>
          <div class="setting-row-action">
            <app-select-box
              [class]="'small-select-box'"
              [type]="'SMALL'"
              [items]="declineOnRequestOptions"
              [selected]="declineOnRequestOption"
              (selectedChange)="setDeclineOnRequestOption($event?.id)"
            ></app-select-box>
          </div>
        </div>
        <div
          class="setting-row-group"
          @vshrink
          *ngIf="['ALWAYS', 'WHEN_SLEEPING'].includes(declineOnRequestOption?.id ?? '')"
        >
          <div class="setting-row">
            <div class="setting-row-label" translate>
              <span translate
                >auto-invite-request-accept.options.declineOnRequest.customMessage.title</span
              >
              <span translate
                >auto-invite-request-accept.options.declineOnRequest.customMessage.description</span
              >
            </div>
            <div class="setting-row-action">
              <input
                maxlength="64"
                type="text"
                class="input"
                [value]="config.declineInviteRequestMessage"
                (change)="
                  updateDeclineInviteRequestCustomMessage.next(
                    declineOnRequestCustomMessageInput.value
                  )
                "
                (blur)="
                  declineOnRequestCustomMessageInput.value = config.declineInviteRequestMessage
                "
                [placeholder]="
                  'auto-invite-request-accept.options.declineOnRequest.customMessage.placeholder'
                    | translate
                "
                #declineOnRequestCustomMessageInput
              />
            </div>
          </div>
        </div>
      </div>
      <h2 translate>auto-invite-request-accept.conditions.title</h2>
      <p translate>auto-invite-request-accept.conditions.description</p>
      <div class="settings">
        <div class="setting-row">
          <div class="setting-row-label" translate>
            <span translate>auto-invite-request-accept.options.onlyIfSleepModeEnabled.title</span>
            <span translate></span>
          </div>
          <div class="setting-row-action">
            <label class="switch-toggle">
              <input
                type="checkbox"
                [checked]="config.onlyIfSleepModeEnabled"
                (change)="updateConfig({ onlyIfSleepModeEnabled: !config.onlyIfSleepModeEnabled })"
              />
              <span class="switch-toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="setting-row">
          <div class="setting-row-label" translate>
            <span
              style="display: initial"
              [innerHtml]="
                'auto-invite-request-accept.options.onlyBelowPlayerCount.title'
                  | translate
                    : {
                        count: config.onlyBelowPlayerCount
                      }
              "
            ></span>
            <span translate
              >auto-invite-request-accept.options.onlyBelowPlayerCount.description</span
            >
          </div>
          <div class="setting-row-action">
            <app-slider-setting
              class="with-margin"
              [unit]="'<i class=&quot;material-icons&quot;>person</i>'"
              [min]="2"
              [max]="100"
              [value]="config.onlyBelowPlayerCount"
              (valueChange)="updateConfig({ onlyBelowPlayerCount: $event })"
              [disabled]="!config.onlyBelowPlayerCountEnabled"
            ></app-slider-setting>
            <label class="switch-toggle">
              <input
                type="checkbox"
                [checked]="config.onlyBelowPlayerCountEnabled"
                (change)="
                  updateConfig({
                    onlyBelowPlayerCountEnabled: !config.onlyBelowPlayerCountEnabled
                  })
                "
              />
              <span class="switch-toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
      <h2 translate>auto-invite-request-accept.otherAutomations.title</h2>
      <p translate>auto-invite-request-accept.otherAutomations.description</p>
      <div class="settings">
        <div class="setting-row">
          <div class="setting-row-label" translate>
            <span translate
              >auto-invite-request-accept.options.declineOnInviteWhileAsleep.title</span
            >
            <span translate
              >auto-invite-request-accept.options.declineOnInviteWhileAsleep.description</span
            >
          </div>
          <div class="setting-row-action">
            <label class="switch-toggle">
              <input
                type="checkbox"
                [checked]="config.declineInvitesWhileAsleep"
                (change)="
                  updateConfig({ declineInvitesWhileAsleep: !config.declineInvitesWhileAsleep })
                "
              />
              <span class="switch-toggle-slider"></span>
            </label>
          </div>
        </div>
        <div class="setting-row-group" @vshrink *ngIf="config.declineInvitesWhileAsleep">
          <div class="setting-row">
            <div class="setting-row-label" translate>
              <span translate
                >auto-invite-request-accept.options.declineOnInviteWhileAsleep.customMessage.title</span
              >
              <span></span>
            </div>
            <div class="setting-row-action">
              <input
                maxlength="64"
                type="text"
                class="input"
                [value]="config.declineInviteMessage"
                (change)="
                  updateDeclineInviteWhileAsleepCustomMessage.next(
                    declineOnInviteCustomMessageInput.value
                  )
                "
                (blur)="declineOnInviteCustomMessageInput.value = config.declineInviteMessage"
                [placeholder]="
                  'auto-invite-request-accept.options.declineOnInviteWhileAsleep.customMessage.placeholder'
                    | translate
                "
                #declineOnInviteCustomMessageInput
              />
            </div>
          </div>
        </div>
        <div class="setting-row">
          <div class="setting-row-label" translate>
            <span translate>auto-invite-request-accept.options.playSoundOnInviteRequest.title</span>
            <span translate
              >auto-invite-request-accept.options.playSoundOnInviteRequest.description</span
            >
          </div>
          <div class="setting-row-action">
            <label class="switch-toggle">
              <input
                type="checkbox"
                [checked]="config.playSoundOnInviteRequest"
                (change)="
                  updateConfig({ playSoundOnInviteRequest: !config.playSoundOnInviteRequest })
                "
              />
              <span class="switch-toggle-slider"></span>
            </label>
          </div>
        </div>
        <div class="setting-row-group" @vshrink *ngIf="config.playSoundOnInviteRequest">
          <div class="setting-row">
            <div class="setting-row-label" translate>
              <span translate
                >auto-invite-request-accept.options.playSoundOnInviteRequest.onlyWhenAsleep.title</span
              >
              <span translate
                >auto-invite-request-accept.options.playSoundOnInviteRequest.onlyWhenAsleep.description</span
              >
            </div>
            <div class="setting-row-action">
              <label class="switch-toggle">
                <input
                  type="checkbox"
                  [checked]="config.playSoundOnInviteRequest_onlyWhenAsleep"
                  (change)="
                    updateConfig({
                      playSoundOnInviteRequest_onlyWhenAsleep:
                        !config.playSoundOnInviteRequest_onlyWhenAsleep
                    })
                  "
                />
                <span class="switch-toggle-slider"></span>
              </label>
            </div>
          </div>
          <div class="setting-row">
            <div class="setting-row-label" translate>
              <span translate
                >auto-invite-request-accept.options.playSoundOnInviteRequest.onlyWhenUnhandled.title</span
              >
              <span translate
                >auto-invite-request-accept.options.playSoundOnInviteRequest.onlyWhenUnhandled.description</span
              >
            </div>
            <div class="setting-row-action">
              <label class="switch-toggle">
                <input
                  type="checkbox"
                  [checked]="config.playSoundOnInviteRequest_onlyWhenUnhandled"
                  (change)="
                    updateConfig({
                      playSoundOnInviteRequest_onlyWhenUnhandled:
                        !config.playSoundOnInviteRequest_onlyWhenUnhandled
                    })
                  "
                />
                <span class="switch-toggle-slider"></span>
              </label>
            </div>
          </div>
          <div class="setting-row">
            <div class="setting-row-label" translate>
              <span translate
                >auto-invite-request-accept.options.playSoundOnInviteRequest.volume.title</span
              >
              <span translate
                >auto-invite-request-accept.options.playSoundOnInviteRequest.volume.description</span
              >
            </div>
            <div class="setting-row-action">
              <button class="btn btn-secondary" (click)="testInviteRequestSound()">
                <span translate @hshrink *ngIf="!playingTestInviteRequestSound"
                  >nightmare-detection.playSound.volume.test</span
                >
                <i class="material-icons" @hshrink *ngIf="playingTestInviteRequestSound"
                  >volume_up</i
                >
              </button>
              <app-slider-setting
                [unit]="'%'"
                [max]="200"
                [snapValues]="[50, 100, 150]"
                [value]="config.playSoundOnInviteRequest_volume"
                (valueChange)="updateConfig({ playSoundOnInviteRequest_volume: $event })"
              ></app-slider-setting>
            </div>
          </div>
        </div>
        <div class="setting-row">
          <div class="setting-row-label" translate>
            <span translate>auto-invite-request-accept.options.playSoundOnInvite.title</span>
            <span translate>auto-invite-request-accept.options.playSoundOnInvite.description</span>
          </div>
          <div class="setting-row-action">
            <label class="switch-toggle">
              <input
                type="checkbox"
                [checked]="config.playSoundOnInvite"
                (change)="updateConfig({ playSoundOnInvite: !config.playSoundOnInvite })"
              />
              <span class="switch-toggle-slider"></span>
            </label>
          </div>
        </div>
        <div class="setting-row-group" @vshrink *ngIf="config.playSoundOnInvite">
          <div class="setting-row">
            <div class="setting-row-label" translate>
              <span translate
                >auto-invite-request-accept.options.playSoundOnInvite.onlyWhenAsleep.title</span
              >
              <span translate
                >auto-invite-request-accept.options.playSoundOnInvite.onlyWhenAsleep.description</span
              >
            </div>
            <div class="setting-row-action">
              <label class="switch-toggle">
                <input
                  type="checkbox"
                  [checked]="config.playSoundOnInvite_onlyWhenAsleep"
                  (change)="
                    updateConfig({
                      playSoundOnInvite_onlyWhenAsleep: !config.playSoundOnInvite_onlyWhenAsleep
                    })
                  "
                />
                <span class="switch-toggle-slider"></span>
              </label>
            </div>
          </div>
          <div class="setting-row">
            <div class="setting-row-label" translate>
              <span translate
                >auto-invite-request-accept.options.playSoundOnInvite.volume.title</span
              >
              <span translate
                >auto-invite-request-accept.options.playSoundOnInvite.volume.description</span
              >
            </div>
            <div class="setting-row-action">
              <button class="btn btn-secondary" (click)="testInviteSound()">
                <span translate @hshrink *ngIf="!playingTestInviteSound"
                  >nightmare-detection.playSound.volume.test</span
                >
                <i class="material-icons" @hshrink *ngIf="playingTestInviteSound">volume_up</i>
              </button>
              <app-slider-setting
                [unit]="'%'"
                [max]="200"
                [snapValues]="[50, 100, 150]"
                [value]="config.playSoundOnInvite_volume"
                (valueChange)="updateConfig({ playSoundOnInvite_volume: $event })"
              ></app-slider-setting>
            </div>
          </div>
        </div>
        <div class="setting-row">
          <div class="setting-row-label" translate>
            <span translate
              >auto-invite-request-accept.options.changeListPreset.onSleepEnable.title</span
            >
            <span translate
              >auto-invite-request-accept.options.changeListPreset.onSleepEnable.description</span
            >
          </div>
          <div class="setting-row-action">
            <app-select-box
              class="preset-select-box"
              [type]="'SMALL'"
              [items]="presetOptions"
              [selected]="presetOption['onSleepEnable']"
              (selectedChange)="setPresetOption('onSleepEnable', $event?.id ?? 'NONE')"
            ></app-select-box>
          </div>
        </div>
        <div class="setting-row">
          <div class="setting-row-label" translate>
            <span translate
              >auto-invite-request-accept.options.changeListPreset.onSleepDisable.title</span
            >
            <span translate
              >auto-invite-request-accept.options.changeListPreset.onSleepDisable.description</span
            >
          </div>
          <div class="setting-row-action">
            <app-select-box
              class="preset-select-box"
              [type]="'SMALL'"
              [items]="presetOptions"
              [selected]="presetOption['onSleepDisable']"
              (selectedChange)="setPresetOption('onSleepDisable', $event?.id ?? 'NONE')"
            ></app-select-box>
          </div>
        </div>
        <div class="setting-row">
          <div class="setting-row-label" translate>
            <span translate
              >auto-invite-request-accept.options.changeListPreset.onSleepPreparation.title</span
            >
            <span translate
              >auto-invite-request-accept.options.changeListPreset.onSleepPreparation.description</span
            >
          </div>
          <div class="setting-row-action">
            <app-select-box
              class="preset-select-box"
              [type]="'SMALL'"
              [items]="presetOptions"
              [selected]="presetOption['onSleepPreparation']"
              (selectedChange)="setPresetOption('onSleepPreparation', $event?.id ?? 'NONE')"
            ></app-select-box>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<app-player-list
  *ngIf="config.listMode !== 'DISABLED'"
  @hshrink
  [title]="
    {
      WHITELIST: 'auto-invite-request-accept.whitelist',
      BLACKLIST: 'auto-invite-request-accept.blacklist'
    }[config.listMode]
  "
  [playerIds]="playerIds"
  (playerIdsChange)="updatePlayerIds($event)"
></app-player-list>
